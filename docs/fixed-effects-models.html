<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Fixed-Effects Models | R Scripts for Longitudinal and Panel Data</title>
  <meta name="description" content="R scripts" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Fixed-Effects Models | R Scripts for Longitudinal and Panel Data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="R scripts" />
  <meta name="github-repo" content="https://github.com/openacttexts/Loss-Data-Analytics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Fixed-Effects Models | R Scripts for Longitudinal and Panel Data" />
  
  <meta name="twitter:description" content="R scripts" />
  

<meta name="author" content="Yumo Dong, Edward Frees, and others??" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html">
<link rel="next" href="models-with-random-effects.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#import-data"><i class="fa fa-check"></i><b>1.1</b> Import Data</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#example-1.1-divorce-rates-page-2"><i class="fa fa-check"></i><b>1.2</b> Example 1.1: Divorce Rates (page 2)</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#figure-1.1-plot-of-1965-divorce-rates-versus-afdc-payments."><i class="fa fa-check"></i><b>1.2.1</b> Figure 1.1: Plot of 1965 divorce rates versus AFDC payments.</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#figure-1.2-plot-of-divorce-rate-versus-afdc-payments-from-1965-and-1975."><i class="fa fa-check"></i><b>1.2.2</b> Figure 1.2: Plot of divorce rate versus AFDC payments from 1965 and 1975.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html"><i class="fa fa-check"></i><b>2</b> Fixed-Effects Models</a><ul>
<li class="chapter" data-level="2.1" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html#import-data-1"><i class="fa fa-check"></i><b>2.1</b> Import Data</a></li>
<li class="chapter" data-level="2.2" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html#example-2.2-medicare-hospital-costs-page-26"><i class="fa fa-check"></i><b>2.2</b> Example 2.2: Medicare Hospital Costs (Page 26)</a><ul>
<li class="chapter" data-level="2.2.1" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html#figure-2.1-ccpd-vs-year-multiple-time-series-plot"><i class="fa fa-check"></i><b>2.2.1</b> FIGURE 2.1: CCPD vs YEAR; multiple time series plot</a></li>
<li class="chapter" data-level="2.2.2" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html#figure-2.2-ccpd-vs-num.dchg"><i class="fa fa-check"></i><b>2.2.2</b> FIGURE 2.2: CCPD vs NUM.DCHG</a></li>
<li class="chapter" data-level="2.2.3" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html#figure-2.3-ccpd-vs-ave.days"><i class="fa fa-check"></i><b>2.2.3</b> Figure 2.3: CCPD vs AVE.DAYS</a></li>
<li class="chapter" data-level="2.2.4" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html#figure-2.4-added-variable-plot-of-ccpd-versus-year"><i class="fa fa-check"></i><b>2.2.4</b> Figure 2.4: Added-variable plot of CCPD versus year</a></li>
<li class="chapter" data-level="2.2.5" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html#figure-2.5-trellis-plot"><i class="fa fa-check"></i><b>2.2.5</b> Figure 2.5: Trellis Plot</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html#one-way-fixed-effects-model-using-lm-for-linear-model"><i class="fa fa-check"></i><b>2.3</b> One way fixed effects model using lm, for linear model</a></li>
<li class="chapter" data-level="2.4" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html#section-2.4.1---analysis-for-the-pooling-test"><i class="fa fa-check"></i><b>2.4</b> SECTION 2.4.1 - Analysis for the pooling test;</a></li>
<li class="chapter" data-level="2.5" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html#section-2.4.2---correlation-corresponding-to-the-added-variable-plot"><i class="fa fa-check"></i><b>2.5</b> SECTION 2.4.2 - Correlation corresponding to the added variable plot;</a></li>
<li class="chapter" data-level="2.6" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html#section-2.4.5---testing-for-heteroscedasticity"><i class="fa fa-check"></i><b>2.6</b> SECTION 2.4.5 - Testing for heteroscedasticity;</a><ul>
<li class="chapter" data-level="2.6.1" data-path="fixed-effects-models.html"><a href="fixed-effects-models.html#one-way-random-effects-model-using-lm-for-linear-model"><i class="fa fa-check"></i><b>2.6.1</b> One way random effects model using lm, for linear model;</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html"><i class="fa fa-check"></i><b>3</b> Models with Random Effects</a><ul>
<li class="chapter" data-level="3.1" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html#import-data-2"><i class="fa fa-check"></i><b>3.1</b> Import Data</a></li>
<li class="chapter" data-level="3.2" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html#example-3.2-income-tax-payments-page-81"><i class="fa fa-check"></i><b>3.2</b> Example 3.2: Income Tax Payments (Page 81)</a><ul>
<li class="chapter" data-level="3.2.1" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html#table-3.2.-averages-of-binary-variables"><i class="fa fa-check"></i><b>3.2.1</b> Table 3.2. Averages of binary variables</a></li>
<li class="chapter" data-level="3.2.2" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html#table-3.3---summary-statistics-for-continuous-variables"><i class="fa fa-check"></i><b>3.2.2</b> TABLE 3.3 - Summary statistics for continuous variables</a></li>
<li class="chapter" data-level="3.2.3" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html#table-3.4---averages-by-level-of-binary-explanatory-variable"><i class="fa fa-check"></i><b>3.2.3</b> TABLE 3.4 - Averages by level of binary explanatory variable</a></li>
<li class="chapter" data-level="3.2.4" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html#table-3.5---correlation-for-continous-variables"><i class="fa fa-check"></i><b>3.2.4</b> TABLE 3.5 - Correlation for continous variables</a></li>
<li class="chapter" data-level="3.2.5" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html#figure-3.2-basic-added-variable-plot-y-vs.-x"><i class="fa fa-check"></i><b>3.2.5</b> FIGURE 3.2: Basic added variable plot (y vs. x)</a></li>
<li class="chapter" data-level="3.2.6" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html#display-3.1---error-components-model"><i class="fa fa-check"></i><b>3.2.6</b> DISPLAY 3.1 - Error components model</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="models-with-random-effects.html"><a href="models-with-random-effects.html#section-3.3---random-coefficients-model"><i class="fa fa-check"></i><b>3.3</b> SECTION 3.3 - Random coefficients model</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html"><i class="fa fa-check"></i><b>4</b> Prediction and Bayesian Inference</a><ul>
<li class="chapter" data-level="4.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#import-data-3"><i class="fa fa-check"></i><b>4.1</b> Import Data</a></li>
<li class="chapter" data-level="4.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#example-forecasting-wisconsin-lottery-sales-page-138"><i class="fa fa-check"></i><b>4.2</b> Example: Forecasting Wisconsin Lottery Sales (Page 138)</a><ul>
<li class="chapter" data-level="4.2.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#table-4.2-time---invariant-summary-statistics"><i class="fa fa-check"></i><b>4.2.1</b> TABLE 4.2: Time - invariant summary statistics</a></li>
<li class="chapter" data-level="4.2.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#figure-4.2-look-at-the-relationship"><i class="fa fa-check"></i><b>4.2.2</b> FIGURE 4.2: Look at the relationship</a></li>
<li class="chapter" data-level="4.2.3" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#sorting-the-data-by-zip-then-combine-vectors-into-another-data.frame"><i class="fa fa-check"></i><b>4.2.3</b> Sorting the data by zip then combine vectors into another data.frame</a></li>
<li class="chapter" data-level="4.2.4" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#figure-4.3-lottery-vs.-week-number"><i class="fa fa-check"></i><b>4.2.4</b> FIGURE 4.3: Lottery vs. week number</a></li>
<li class="chapter" data-level="4.2.5" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#figure-4.4-log-lottery-vs-week-number"><i class="fa fa-check"></i><b>4.2.5</b> FIGURE 4.4: Log lottery vs week number</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#create-model-development-sample"><i class="fa fa-check"></i><b>4.3</b> Create model development sample</a><ul>
<li class="chapter" data-level="4.3.1" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#model-1.-pooled-cross-setional-model"><i class="fa fa-check"></i><b>4.3.1</b> MODEL 1. Pooled cross-setional model</a></li>
<li class="chapter" data-level="4.3.2" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#model-2.-error-components-model"><i class="fa fa-check"></i><b>4.3.2</b> MODEL 2. Error components model</a></li>
<li class="chapter" data-level="4.3.3" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#model-3.-error-components-model-with-autocorrelated-errors"><i class="fa fa-check"></i><b>4.3.3</b> MODEL 3. Error components model with autocorrelated errors</a></li>
<li class="chapter" data-level="4.3.4" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#model-4.-more-parsimonious-random-effects-model"><i class="fa fa-check"></i><b>4.3.4</b> MODEL 4. More parsimonious random effects model</a></li>
<li class="chapter" data-level="4.3.5" data-path="prediction-and-bayesian-inference.html"><a href="prediction-and-bayesian-inference.html#model-5.-fixed-effects-model-with-autocorrelated-errors"><i class="fa fa-check"></i><b>4.3.5</b> MODEL 5. Fixed effects model with autocorrelated errors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multilevel-models.html"><a href="multilevel-models.html"><i class="fa fa-check"></i><b>5</b> Multilevel Models</a><ul>
<li class="chapter" data-level="5.1" data-path="multilevel-models.html"><a href="multilevel-models.html#import-data-4"><i class="fa fa-check"></i><b>5.1</b> Import Data</a></li>
<li class="chapter" data-level="5.2" data-path="multilevel-models.html"><a href="multilevel-models.html#example-5.2-dental-data-page-175"><i class="fa fa-check"></i><b>5.2</b> Example 5.2: Dental Data (Page 175)</a><ul>
<li class="chapter" data-level="5.2.1" data-path="multilevel-models.html"><a href="multilevel-models.html#figure-5.1.-multiple-time-series-plot"><i class="fa fa-check"></i><b>5.2.1</b> Figure 5.1. Multiple time series plot</a></li>
<li class="chapter" data-level="5.2.2" data-path="multilevel-models.html"><a href="multilevel-models.html#summary-statistics"><i class="fa fa-check"></i><b>5.2.2</b> Summary statistics</a></li>
<li class="chapter" data-level="5.2.3" data-path="multilevel-models.html"><a href="multilevel-models.html#trellis-plot-unique-in-r"><i class="fa fa-check"></i><b>5.2.3</b> Trellis plot, unique in r</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="multilevel-models.html"><a href="multilevel-models.html#table-5.2-dental-data-growth-curve-model-parameter-estimates"><i class="fa fa-check"></i><b>5.3</b> TABLE 5.2: Dental data growth-curve-model parameter estimates</a><ul>
<li class="chapter" data-level="5.3.1" data-path="multilevel-models.html"><a href="multilevel-models.html#table-5.2-error-components-model"><i class="fa fa-check"></i><b>5.3.1</b> TABLE 5.2: Error components model</a></li>
<li class="chapter" data-level="5.3.2" data-path="multilevel-models.html"><a href="multilevel-models.html#table-5.2-growth-curve-model"><i class="fa fa-check"></i><b>5.3.2</b> TABLE 5.2: Growth curve model</a></li>
<li class="chapter" data-level="5.3.3" data-path="multilevel-models.html"><a href="multilevel-models.html#table-5.2-growth-curve-model---omitting-9th-boy"><i class="fa fa-check"></i><b>5.3.3</b> TABLE 5.2: Growth curve model - omitting 9th boy</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modeling-issues.html"><a href="modeling-issues.html"><i class="fa fa-check"></i><b>6</b> Modeling Issues</a><ul>
<li class="chapter" data-level="6.1" data-path="modeling-issues.html"><a href="modeling-issues.html#import-data-5"><i class="fa fa-check"></i><b>6.1</b> Import Data</a></li>
<li class="chapter" data-level="6.2" data-path="modeling-issues.html"><a href="modeling-issues.html#example-7.2-income-tax-payments-page-248"><i class="fa fa-check"></i><b>6.2</b> Example 7.2: Income Tax Payments (Page 248)</a><ul>
<li class="chapter" data-level="6.2.1" data-path="modeling-issues.html"><a href="modeling-issues.html#table-7.1-fixed-effects-estimators"><i class="fa fa-check"></i><b>6.2.1</b> TABLE 7.1: Fixed effects estimators</a></li>
<li class="chapter" data-level="6.2.2" data-path="modeling-issues.html"><a href="modeling-issues.html#table-7.1-random-effects-estimator"><i class="fa fa-check"></i><b>6.2.2</b> TABLE 7.1: Random effects estimator</a></li>
<li class="chapter" data-level="6.2.3" data-path="modeling-issues.html"><a href="modeling-issues.html#hausmans-test"><i class="fa fa-check"></i><b>6.2.3</b> Hausman’s test</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="modeling-issues.html"><a href="modeling-issues.html#example-7.2-income-tax-payments-continued-page-255"><i class="fa fa-check"></i><b>6.3</b> Example 7.2: Income Tax Payments (continued) (Page 255)</a><ul>
<li class="chapter" data-level="6.3.1" data-path="modeling-issues.html"><a href="modeling-issues.html#table-7.2-fixed-effects-estimators-with-two-variable-slopes"><i class="fa fa-check"></i><b>6.3.1</b> Table 7.2: Fixed effects estimators with two variable slopes</a></li>
<li class="chapter" data-level="6.3.2" data-path="modeling-issues.html"><a href="modeling-issues.html#table-7.2-variable-slopes-model"><i class="fa fa-check"></i><b>6.3.2</b> Table 7.2: Variable slopes model</a></li>
<li class="chapter" data-level="6.3.3" data-path="modeling-issues.html"><a href="modeling-issues.html#hausmans-test-1"><i class="fa fa-check"></i><b>6.3.3</b> Hausman’s test</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="modeling-issues.html"><a href="modeling-issues.html#table-7.3-augmented-regressions"><i class="fa fa-check"></i><b>6.4</b> TABLE 7.3 Augmented regressions</a><ul>
<li class="chapter" data-level="6.4.1" data-path="modeling-issues.html"><a href="modeling-issues.html#create-panel-data-set-with-subject-averages"><i class="fa fa-check"></i><b>6.4.1</b> Create panel data set with subject averages</a></li>
<li class="chapter" data-level="6.4.2" data-path="modeling-issues.html"><a href="modeling-issues.html#models-with-averages-as-omitted-variables"><i class="fa fa-check"></i><b>6.4.2</b> Models with averages as omitted variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="dynamic-models.html"><a href="dynamic-models.html"><i class="fa fa-check"></i><b>7</b> Dynamic Models</a><ul>
<li class="chapter" data-level="7.1" data-path="dynamic-models.html"><a href="dynamic-models.html#import-data-6"><i class="fa fa-check"></i><b>7.1</b> Import Data</a></li>
<li class="chapter" data-level="7.2" data-path="dynamic-models.html"><a href="dynamic-models.html#example-8.6-capital-asset-pricing-model-page-302"><i class="fa fa-check"></i><b>7.2</b> Example 8.6: Capital Asset Pricing Model (Page 302)</a><ul>
<li class="chapter" data-level="7.2.1" data-path="dynamic-models.html"><a href="dynamic-models.html#plot-of-retfree-vs.-vwfree-for-incoln-insurance-company"><i class="fa fa-check"></i><b>7.2.1</b> Plot of RETFREE vs. VWFREE for Incoln insurance company</a></li>
<li class="chapter" data-level="7.2.2" data-path="dynamic-models.html"><a href="dynamic-models.html#plot-of-retfree-vs.-vwfree-for-90-insurance-firms"><i class="fa fa-check"></i><b>7.2.2</b> Plot of RETFREE vs. VWFREE for 90 insurance firms</a></li>
<li class="chapter" data-level="7.2.3" data-path="dynamic-models.html"><a href="dynamic-models.html#plot-of-retfree-vs.-year-for-lincoln-insurance-company"><i class="fa fa-check"></i><b>7.2.3</b> Plot of RETFREE vs. YEAR for Lincoln insurance company</a></li>
<li class="chapter" data-level="7.2.4" data-path="dynamic-models.html"><a href="dynamic-models.html#table-8.2-summary-statistics-for-market-index-and-risk-free-security"><i class="fa fa-check"></i><b>7.2.4</b> Table 8.2 Summary statistics for market index and risk-free security</a></li>
<li class="chapter" data-level="7.2.5" data-path="dynamic-models.html"><a href="dynamic-models.html#table-8.3-summary-statistics-for-individual-security-returns"><i class="fa fa-check"></i><b>7.2.5</b> TABLE 8.3 Summary statistics for individual security returns</a></li>
<li class="chapter" data-level="7.2.6" data-path="dynamic-models.html"><a href="dynamic-models.html#table-8.4-fixed-effects-models"><i class="fa fa-check"></i><b>7.2.6</b> TABLE 8.4 Fixed effects models</a></li>
<li class="chapter" data-level="7.2.7" data-path="dynamic-models.html"><a href="dynamic-models.html#figure-8.1-trellis-plot-of-returns-versus-market-return"><i class="fa fa-check"></i><b>7.2.7</b> Figure 8.1: Trellis plot of returns versus market return</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="binary-dependent-variables.html"><a href="binary-dependent-variables.html"><i class="fa fa-check"></i><b>8</b> Binary Dependent Variables</a><ul>
<li class="chapter" data-level="8.1" data-path="binary-dependent-variables.html"><a href="binary-dependent-variables.html#import-data-7"><i class="fa fa-check"></i><b>8.1</b> Import Data</a></li>
<li class="chapter" data-level="8.2" data-path="binary-dependent-variables.html"><a href="binary-dependent-variables.html#example-income-tax-payments-and-tax-preparers-page-326"><i class="fa fa-check"></i><b>8.2</b> Example: Income Tax Payments and Tax Preparers (page 326)</a><ul>
<li class="chapter" data-level="8.2.1" data-path="binary-dependent-variables.html"><a href="binary-dependent-variables.html#table-9.2.-means-for-binary-variables"><i class="fa fa-check"></i><b>8.2.1</b> TABLE 9.2. Means for binary variables</a></li>
<li class="chapter" data-level="8.2.2" data-path="binary-dependent-variables.html"><a href="binary-dependent-variables.html#table-9.3.-summary-stats-for-other-variables"><i class="fa fa-check"></i><b>8.2.2</b> TABLE 9.3. Summary stats for other variables</a></li>
<li class="chapter" data-level="8.2.3" data-path="binary-dependent-variables.html"><a href="binary-dependent-variables.html#table-9.4.-frequency-tables-for-some-of-the-binary-variables"><i class="fa fa-check"></i><b>8.2.3</b> TABLE 9.4. Frequency tables for some of the binary variables</a></li>
<li class="chapter" data-level="8.2.4" data-path="binary-dependent-variables.html"><a href="binary-dependent-variables.html#display-9.1-fit-the-logistic-distribution-function-using-maximum-likelihood"><i class="fa fa-check"></i><b>8.2.4</b> DISPLAY 9.1 Fit the logistic distribution function using maximum likelihood</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="binary-dependent-variables.html"><a href="binary-dependent-variables.html#section-9.2-random-effects-nonlinear-mixed-effects-model"><i class="fa fa-check"></i><b>8.3</b> SECTION 9.2 Random effects nonlinear mixed effects model</a><ul>
<li class="chapter" data-level="8.3.1" data-path="binary-dependent-variables.html"><a href="binary-dependent-variables.html#generalized-linear-mixed-effects-model"><i class="fa fa-check"></i><b>8.3.1</b> Generalized linear mixed effects model</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="binary-dependent-variables.html"><a href="binary-dependent-variables.html#section-9.3-fixed-effect-model"><i class="fa fa-check"></i><b>8.4</b> SECTION 9.3 Fixed effect model</a></li>
<li class="chapter" data-level="8.5" data-path="binary-dependent-variables.html"><a href="binary-dependent-variables.html#section-9.4-marginal-model-and-generalized-equation-estimation"><i class="fa fa-check"></i><b>8.5</b> SECTION 9.4 Marginal model and generalized equation estimation</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>9</b> Generalized Linear Models</a><ul>
<li class="chapter" data-level="9.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#import-data-8"><i class="fa fa-check"></i><b>9.1</b> Import Data</a></li>
<li class="chapter" data-level="9.2" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#example-tort-filings-page-356"><i class="fa fa-check"></i><b>9.2</b> Example: Tort Filings (Page 356)</a><ul>
<li class="chapter" data-level="9.2.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#table-10.3-averages-with-explanatory-binary-variables"><i class="fa fa-check"></i><b>9.2.1</b> TABLE 10.3 Averages with explanatory binary variables</a></li>
<li class="chapter" data-level="9.2.2" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#table-10.4-summary-statistics-for-other-variables"><i class="fa fa-check"></i><b>9.2.2</b> TABLE 10.4 Summary statistics for other variables</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#section-10.2-homogeneous-model"><i class="fa fa-check"></i><b>9.3</b> Section 10.2 Homogeneous model</a><ul>
<li class="chapter" data-level="9.3.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#table-10.5-tort-filings-model-coefficient-estimates"><i class="fa fa-check"></i><b>9.3.1</b> TABLE 10.5 Tort filings model coefficient estimates</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#section-10.3-marginal-models"><i class="fa fa-check"></i><b>9.4</b> Section 10.3 Marginal Models</a><ul>
<li class="chapter" data-level="9.4.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#with-in-state-correlation-independent"><i class="fa fa-check"></i><b>9.4.1</b> With in state correlation independent</a></li>
<li class="chapter" data-level="9.4.2" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#random-effects-model"><i class="fa fa-check"></i><b>9.4.2</b> Random effects model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="categorical-dependent-variables-and-survival-models.html"><a href="categorical-dependent-variables-and-survival-models.html"><i class="fa fa-check"></i><b>10</b> Categorical Dependent Variables and Survival Models</a><ul>
<li class="chapter" data-level="10.1" data-path="categorical-dependent-variables-and-survival-models.html"><a href="categorical-dependent-variables-and-survival-models.html#import-data-9"><i class="fa fa-check"></i><b>10.1</b> Import Data</a></li>
<li class="chapter" data-level="10.2" data-path="categorical-dependent-variables-and-survival-models.html"><a href="categorical-dependent-variables-and-survival-models.html#chap11yogurt2013.r"><i class="fa fa-check"></i><b>10.2</b> Chap11Yogurt2013.R</a></li>
<li class="chapter" data-level="10.3" data-path="categorical-dependent-variables-and-survival-models.html"><a href="categorical-dependent-variables-and-survival-models.html#table-11.2-number-of-choices"><i class="fa fa-check"></i><b>10.3</b> Table 11.2 Number of Choices</a><ul>
<li class="chapter" data-level="10.3.1" data-path="categorical-dependent-variables-and-survival-models.html"><a href="categorical-dependent-variables-and-survival-models.html#table-11.2-basic-summary-statistics-for-prices"><i class="fa fa-check"></i><b>10.3.1</b> Table 11.2 Basic summary statistics for prices</a></li>
<li class="chapter" data-level="10.3.2" data-path="categorical-dependent-variables-and-survival-models.html"><a href="categorical-dependent-variables-and-survival-models.html#vissualize-the-data"><i class="fa fa-check"></i><b>10.3.2</b> vissualize the data</a></li>
<li class="chapter" data-level="10.3.3" data-path="categorical-dependent-variables-and-survival-models.html"><a href="categorical-dependent-variables-and-survival-models.html#note-the-small-relationships-among-prices"><i class="fa fa-check"></i><b>10.3.3</b> Note the small relationships among prices</a></li>
<li class="chapter" data-level="10.3.4" data-path="categorical-dependent-variables-and-survival-models.html"><a href="categorical-dependent-variables-and-survival-models.html#more-on-prices"><i class="fa fa-check"></i><b>10.3.4</b> More on prices</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="categorical-dependent-variables-and-survival-models.html"><a href="categorical-dependent-variables-and-survival-models.html#fitting-fixed-effects-multinomial-logit-model-by-the-poisson-log-linear-model"><i class="fa fa-check"></i><b>10.4</b> Fitting fixed effects multinomial logit model by the poisson log-linear model</a></li>
<li class="chapter" data-level="10.5" data-path="categorical-dependent-variables-and-survival-models.html"><a href="categorical-dependent-variables-and-survival-models.html#fitting-multinomial-logit-model-with-random-intercepts-by-the-possion-log-linear-with-random-intercepts"><i class="fa fa-check"></i><b>10.5</b> Fitting multinomial logit model with random intercepts by the possion-log-linear with random intercepts</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Scripts for Longitudinal and Panel Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fixed-effects-models" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Fixed-Effects Models</h1>
<div id="import-data-1" class="section level2">
<h2><span class="header-section-number">2.1</span> Import Data</h2>
<p>We consider T=6 years, 1990-1995, of data for inpatient hospital charges that are covered by the Medicare program. The data were obtained from the Health Care Financing Administration, Bureau of Data Management and Strategy. To illustrate, in 1995 the total covered charges were $157.8 billions for twelve million discharges. For this analysis, we use state as the subject, or risk class. Thus, we consider n=54 states that include the 50 states in the Union, the District of Columbia, Virgin Islands, Puerto Rico and an unspecified “other” category.</p>
<table>
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>STATE</td>
<td>State identifier, 1-54</td>
</tr>
<tr class="even">
<td>YEAR</td>
<td>Year identifier, 1-6</td>
</tr>
<tr class="odd">
<td>TOT_CHG</td>
<td>Total hospital charges, in millions of dollars.</td>
</tr>
<tr class="even">
<td>COV_CHG</td>
<td>Total hospital charges covered by Medicare, in millions of dollars.</td>
</tr>
<tr class="odd">
<td>MED_REIM</td>
<td>Total hospital charges reimbursed by the Medicare program, in millions of dollars.</td>
</tr>
<tr class="even">
<td>TOT_D</td>
<td>Total number of hospitals stays, in days.</td>
</tr>
<tr class="odd">
<td>NUM_DSHG</td>
<td>Number discharged, in thousands.</td>
</tr>
<tr class="even">
<td>AVE_T_D</td>
<td>Average hospital stay per discharge in days.</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#  &quot;\t&quot;  INDICATES SEPARATED BY TABLES  ;</span>
Medicare  =<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;TXTData/Medicare.txt&quot;</span>, <span class="dt">sep =</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">quote =</span> <span class="st">&quot;&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>)

<span class="co"># Medicare = read.table(choose.files(), sep =&quot;\t&quot;, quote = &quot;&quot;,header=TRUE)</span></code></pre>
<p>Let’s have a look at the dataset. The names of variables and the first 8 rows observations.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#  PROVIDES THE NAMES IN THE FILE AND LISTS THE FIRST 8 OBSERVATIONS  ;</span>
<span class="kw">names</span> (Medicare)</code></pre>
<pre><code>[1] &quot;STATE&quot;    &quot;YEAR&quot;     &quot;TOT_CHG&quot;  &quot;COV_CHG&quot;  &quot;MED_REIB&quot; &quot;TOT_D&quot;   
[7] &quot;NUM_DCHG&quot; &quot;AVE_T_D&quot;  &quot;NMSTATE&quot; </code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Medicare [<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, ]</code></pre>
<pre><code>  STATE YEAR    TOT_CHG    COV_CHG   MED_REIB   TOT_D NUM_DCHG AVE_T_D
1     1    1 2211617271 2170240349  972752944 1932673   230015       8
2     1    2 2523987347 2468263759 1046016144 1936939   234739       8
3     1    3 2975969979 2922611694 1205791592 2016354   245027       8
4     1    4 3194595003 3149745611 1307982985 1948427   243947       8
5     1    5 3417704863 3384305357 1376211788 1926335   258384       7
6     1    6 3519375275 3492635576 1466220936 1847216   261738       7
7     2    1   64747759   62242279   42083051   51923     6636       8
8     2    2   70600503   67579913   46928596   53051     6940       8
  NMSTATE
1      AL
2      AL
3      AL
4      AL
5      AL
6      AL
7      AK
8      AK</code></pre>
<p>Then we need to create some other variables for later use.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#  CREATE OTHER VARIABLES;</span>
<span class="co"># Firstly, we need change the names of existing variables.</span>
<span class="kw">names</span>(Medicare)[<span class="kw">names</span>(Medicare)<span class="op">==</span><span class="st">&quot;TOT_CHG&quot;</span>]=<span class="st">&quot;TOT.CHG&quot;</span>;
<span class="kw">names</span>(Medicare)[<span class="kw">names</span>(Medicare)<span class="op">==</span><span class="st">&quot;COV_CHG&quot;</span>]=<span class="st">&quot;COV.CHG&quot;</span>;
<span class="kw">names</span>(Medicare)[<span class="kw">names</span>(Medicare)<span class="op">==</span><span class="st">&quot;MED_REIB&quot;</span>]=<span class="st">&quot;MED.REIB&quot;</span>;
<span class="kw">names</span>(Medicare)[<span class="kw">names</span>(Medicare)<span class="op">==</span><span class="st">&quot;TOT_D&quot;</span>]=<span class="st">&quot;TOT.D&quot;</span>;
<span class="kw">names</span>(Medicare)[<span class="kw">names</span>(Medicare)<span class="op">==</span><span class="st">&quot;NUM_DCHG&quot;</span>]=<span class="st">&quot;NUM.DCHG&quot;</span>;
<span class="kw">names</span>(Medicare)[<span class="kw">names</span>(Medicare)<span class="op">==</span><span class="st">&quot;AVE_T_D&quot;</span>]=<span class="st">&quot;AVE.T.D&quot;</span>;

Medicare<span class="op">$</span>AVE.DAYS=<span class="st"> </span>Medicare<span class="op">$</span>TOT.D<span class="op">/</span>Medicare<span class="op">$</span>NUM.DCHG
Medicare<span class="op">$</span>CCPD=Medicare<span class="op">$</span>COV.CHG<span class="op">/</span>Medicare<span class="op">$</span>NUM.DCHG
Medicare<span class="op">$</span>NUM.DCHG=Medicare<span class="op">$</span>NUM.DCHG<span class="op">/</span><span class="dv">1000</span>
<span class="kw">str</span> (Medicare)</code></pre>
<pre><code>&#39;data.frame&#39;:   324 obs. of  11 variables:
 $ STATE   : int  1 1 1 1 1 1 2 2 2 2 ...
 $ YEAR    : int  1 2 3 4 5 6 1 2 3 4 ...
 $ TOT.CHG : num  2.21e+09 2.52e+09 2.98e+09 3.19e+09 3.42e+09 ...
 $ COV.CHG : num  2.17e+09 2.47e+09 2.92e+09 3.15e+09 3.38e+09 ...
 $ MED.REIB: num  9.73e+08 1.05e+09 1.21e+09 1.31e+09 1.38e+09 ...
 $ TOT.D   : int  1932673 1936939 2016354 1948427 1926335 1847216 51923 53051 55191 53329 ...
 $ NUM.DCHG: num  230 235 245 244 258 ...
 $ AVE.T.D : int  8 8 8 8 7 7 8 8 7 7 ...
 $ NMSTATE : Factor w/ 54 levels &quot;AK&quot;,&quot;AL&quot;,&quot;AR&quot;,..: 2 2 2 2 2 2 1 1 1 1 ...
 $ AVE.DAYS: num  8.4 8.25 8.23 7.99 7.46 ...
 $ CCPD    : num  9435 10515 11928 12912 13098 ...</code></pre>
<p>Some summary statistics of <code>CCPD</code>, <code>NUM.DCHG</code>, <code>AVE&gt;DAYS</code>, <code>YEAR</code> in each year.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(nlme)
<span class="kw">attach</span>(Medicare)
<span class="co">#  SUMMARY STATISTICS ;</span>
<span class="kw">dim</span>(Medicare)</code></pre>
<pre><code>[1] 324  11</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(Medicare[, <span class="kw">c</span>(<span class="st">&quot;CCPD&quot;</span>, <span class="st">&quot;NUM.DCHG&quot;</span>, <span class="st">&quot;AVE.DAYS&quot;</span> )])</code></pre>
<pre><code>      CCPD          NUM.DCHG          AVE.DAYS     
 Min.   : 2966   Min.   :  0.515   Min.   : 5.119  
 1st Qu.: 8537   1st Qu.: 42.715   1st Qu.: 7.162  
 Median :10073   Median :144.282   Median : 8.067  
 Mean   :10483   Mean   :210.731   Mean   : 8.542  
 3rd Qu.:12059   3rd Qu.:282.884   3rd Qu.: 8.988  
 Max.   :21500   Max.   :908.593   Max.   :60.251  </code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gsummary</span>(Medicare[, <span class="kw">c</span>(<span class="st">&quot;CCPD&quot;</span>, <span class="st">&quot;NUM.DCHG&quot;</span>, <span class="st">&quot;AVE.DAYS&quot;</span>, <span class="st">&quot;YEAR&quot;</span>)], <span class="dt">groups =</span> YEAR, <span class="dt">FUN=</span>sd)</code></pre>
<pre><code>      CCPD NUM.DCHG AVE.DAYS YEAR
1 2466.685 202.9918 2.077437    1
2 2711.568 210.3791 7.231312    2
3 3041.274 218.9225 1.858683    3
4 3259.846 219.8253 2.112467    4
5 3345.970 226.7783 1.728882    5
6 3277.985 229.4583 1.444423    6</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gsummary</span>(Medicare[, <span class="kw">c</span>(<span class="st">&quot;CCPD&quot;</span>, <span class="st">&quot;NUM.DCHG&quot;</span>, <span class="st">&quot;AVE.DAYS&quot;</span>, <span class="st">&quot;YEAR&quot;</span>)], <span class="dt">groups =</span> YEAR, <span class="dt">FUN=</span>mean)</code></pre>
<pre><code>       CCPD NUM.DCHG AVE.DAYS YEAR
1  8503.168 197.7274 9.048565    1
2  9472.746 203.1443 9.823055    2
3 10443.285 210.8941 8.619240    3
4 11159.680 211.2479 8.522619    4
5 11522.826 218.8690 7.898816    5
6 11796.768 222.5059 7.342360    6</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gsummary</span>(Medicare[, <span class="kw">c</span>(<span class="st">&quot;CCPD&quot;</span>, <span class="st">&quot;NUM.DCHG&quot;</span>, <span class="st">&quot;AVE.DAYS&quot;</span>, <span class="st">&quot;YEAR&quot;</span>)], <span class="dt">groups =</span> YEAR, <span class="dt">FUN=</span>median)</code></pre>
<pre><code>       CCPD NUM.DCHG AVE.DAYS YEAR
1  7991.927 142.5880 8.533565    1
2  9113.473 142.6935 8.570416    2
3 10055.416 143.2515 8.363435    3
4 10666.865 143.6720 8.112863    4
5 10955.142 150.0765 7.560945    5
6 11171.080 152.6960 7.143355    6</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gsummary</span>(Medicare[, <span class="kw">c</span>(<span class="st">&quot;CCPD&quot;</span>, <span class="st">&quot;NUM.DCHG&quot;</span>, <span class="st">&quot;AVE.DAYS&quot;</span>, <span class="st">&quot;YEAR&quot;</span>)], <span class="dt">groups =</span> YEAR, <span class="dt">FUN=</span>min)</code></pre>
<pre><code>      CCPD NUM.DCHG AVE.DAYS YEAR
1 3228.989    0.528 6.326762    1
2 2966.117    0.515 6.143628    2
3 3324.113    0.653 5.830248    3
4 4137.776    0.969 5.830995    4
5 4354.526    1.156 5.378061    5
6 5058.371    1.059 5.118937    6</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gsummary</span>(Medicare[, <span class="kw">c</span>(<span class="st">&quot;CCPD&quot;</span>, <span class="st">&quot;NUM.DCHG&quot;</span>, <span class="st">&quot;AVE.DAYS&quot;</span>, <span class="st">&quot;YEAR&quot;</span>)], <span class="dt">groups =</span> YEAR, <span class="dt">FUN=</span>max)</code></pre>
<pre><code>      CCPD NUM.DCHG AVE.DAYS YEAR
1 16484.77  849.372 17.47888    1
2 17636.51  885.919 60.25108    2
3 19814.09  908.593 16.35045    3
4 21121.55  894.216 17.13484    4
5 21500.29  905.615 14.38731    5
6 21031.58  902.479 12.79622    6</code></pre>
<p>See the box plots of different variables in each year.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#  ATTACH THE DATA SET FOR SOME PRELIMINARLY LOOKS;</span>
<span class="kw">attach</span> (Medicare)</code></pre>
<pre><code>The following objects are masked from Medicare (pos = 3):

    AVE.DAYS, AVE.T.D, CCPD, COV.CHG, MED.REIB, NMSTATE, NUM.DCHG,
    STATE, TOT.CHG, TOT.D, YEAR</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Medicare<span class="op">$</span>YEAR=Medicare<span class="op">$</span>YEAR<span class="op">+</span><span class="dv">1989</span>
<span class="kw">boxplot</span> (CCPD <span class="op">~</span><span class="st"> </span>YEAR)</code></pre>
<p><img src="LongPanelDataScripts_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span> (NUM.DCHG <span class="op">~</span><span class="st"> </span>YEAR)</code></pre>
<p><img src="LongPanelDataScripts_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span> (AVE.DAYS <span class="op">~</span><span class="st"> </span>YEAR)</code></pre>
<p><img src="LongPanelDataScripts_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
</div>
<div id="example-2.2-medicare-hospital-costs-page-26" class="section level2">
<h2><span class="header-section-number">2.2</span> Example 2.2: Medicare Hospital Costs (Page 26)</h2>
<div id="figure-2.1-ccpd-vs-year-multiple-time-series-plot" class="section level3">
<h3><span class="header-section-number">2.2.1</span> FIGURE 2.1: CCPD vs YEAR; multiple time series plot</h3>
<p>Figure 2.1 illustrates the multiple time-series plot. Here, we see that not only are overall claims increasing but also that claims increase for each state.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(CCPD <span class="op">~</span><span class="st"> </span>YEAR, <span class="dt">data =</span> Medicare, <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>)
 <span class="cf">for</span> (i <span class="cf">in</span> Medicare<span class="op">$</span>STATE) {
 <span class="kw">lines</span>(CCPD <span class="op">~</span><span class="st"> </span>YEAR, <span class="dt">data =</span> <span class="kw">subset</span>(Medicare, STATE <span class="op">==</span><span class="st"> </span>i)) }
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">22000</span>, <span class="dt">by=</span><span class="dv">2000</span>), <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">font=</span><span class="dv">10</span>, <span class="dt">cex=</span><span class="fl">0.005</span>, <span class="dt">tck=</span><span class="fl">0.01</span>)
<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">1990</span>,<span class="dv">1995</span>, <span class="dt">by=</span><span class="dv">1</span>), <span class="dt">font=</span><span class="dv">10</span>, <span class="dt">cex=</span><span class="fl">0.005</span>, <span class="dt">tck=</span><span class="fl">0.01</span>)
<span class="kw">mtext</span>(<span class="st">&quot;CCPD&quot;</span>, <span class="dt">side=</span><span class="dv">2</span>, <span class="dt">line=</span><span class="dv">0</span>, <span class="dt">at=</span><span class="dv">23000</span>, <span class="dt">font=</span><span class="dv">12</span>, <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">mtext</span>(<span class="st">&quot;YEAR&quot;</span>, <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">line=</span><span class="dv">3</span>, <span class="dt">at=</span><span class="fl">1992.5</span>, <span class="dt">font=</span><span class="dv">12</span>, <span class="dt">cex=</span><span class="dv">1</span>)</code></pre>
<p><img src="LongPanelDataScripts_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="figure-2.2-ccpd-vs-num.dchg" class="section level3">
<h3><span class="header-section-number">2.2.2</span> FIGURE 2.2: CCPD vs NUM.DCHG</h3>
<p>Figure 2.2 illustrates the scatter plot with symbols. This plot ofCCPD versus number ofdischarges, connecting observations over time, shows a positive overall relationship between CCPD and the number of discharges.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(CCPD <span class="op">~</span><span class="st"> </span>NUM.DCHG, <span class="dt">data =</span> Medicare, <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>)
<span class="cf">for</span> (i <span class="cf">in</span> Medicare<span class="op">$</span>STATE) {
 <span class="kw">lines</span>(CCPD <span class="op">~</span><span class="st"> </span>NUM.DCHG, <span class="dt">data =</span> <span class="kw">subset</span>(Medicare, STATE <span class="op">==</span><span class="st"> </span>i)) }
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">22000</span>, <span class="dt">by=</span><span class="dv">2000</span>), <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">font=</span><span class="dv">10</span>, <span class="dt">cex=</span><span class="fl">0.005</span>, <span class="dt">tck=</span><span class="fl">0.01</span>)
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">22000</span>, <span class="dt">by=</span><span class="dv">200</span>), <span class="dt">lab=</span>F, <span class="dt">tck=</span><span class="fl">0.005</span>)
<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1200</span>, <span class="dt">by=</span><span class="dv">200</span>), <span class="dt">font=</span><span class="dv">10</span>, <span class="dt">cex=</span><span class="fl">0.005</span>, <span class="dt">tck=</span><span class="fl">0.01</span>)
<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1200</span>, <span class="dt">by=</span><span class="dv">20</span>), <span class="dt">lab=</span>F, <span class="dt">tck=</span><span class="fl">0.005</span>)
<span class="kw">mtext</span>(<span class="st">&quot;CCPD&quot;</span>, <span class="dt">side=</span><span class="dv">2</span>, <span class="dt">line=</span><span class="dv">0</span>, <span class="dt">at=</span><span class="dv">23000</span>, <span class="dt">font=</span><span class="dv">12</span>, <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Number of Discharges in Thousands&quot;</span>, <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">line=</span><span class="dv">3</span>, <span class="dt">at=</span><span class="dv">500</span>, <span class="dt">font=</span><span class="dv">12</span>, <span class="dt">cex=</span><span class="dv">1</span>)</code></pre>
<p><img src="LongPanelDataScripts_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="figure-2.3-ccpd-vs-ave.days" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Figure 2.3: CCPD vs AVE.DAYS</h3>
<p>Figure 2.3 is a scatter plot of CCPD versus average total days, connecting observations over time. This plot demonstrates the unusual nature of the second observation for the 54th state.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(CCPD <span class="op">~</span><span class="st"> </span>AVE.DAYS, <span class="dt">data =</span> Medicare, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>)
<span class="cf">for</span> (i <span class="cf">in</span> Medicare<span class="op">$</span>STATE) {
 <span class="kw">lines</span>(CCPD <span class="op">~</span><span class="st"> </span>AVE.DAYS, <span class="dt">data =</span> <span class="kw">subset</span>(Medicare, STATE<span class="op">==</span><span class="st"> </span>i)) }
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">22000</span>, <span class="dt">by=</span><span class="dv">2000</span>), <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">font=</span><span class="dv">10</span>, <span class="dt">cex=</span><span class="fl">0.005</span>, <span class="dt">tck=</span><span class="fl">0.01</span>)
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">22000</span>, <span class="dt">by=</span><span class="dv">200</span>), <span class="dt">lab=</span>F, <span class="dt">tck=</span><span class="fl">0.005</span>)
<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">70</span>, <span class="dt">by=</span><span class="dv">10</span>), <span class="dt">font=</span><span class="dv">10</span>, <span class="dt">cex=</span><span class="fl">0.005</span>, <span class="dt">tck=</span><span class="fl">0.01</span>)
<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">70</span>, <span class="dt">by=</span><span class="dv">1</span>), <span class="dt">lab=</span>F, <span class="dt">tck=</span><span class="fl">0.005</span>)
<span class="kw">mtext</span>(<span class="st">&quot;CCPD&quot;</span>, <span class="dt">side=</span><span class="dv">2</span>, <span class="dt">line=</span><span class="dv">0</span>, <span class="dt">at=</span><span class="dv">23000</span>, <span class="dt">font=</span><span class="dv">12</span>, <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Average Hospital Stay&quot;</span>, <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">line=</span><span class="dv">3</span>, <span class="dt">at=</span><span class="dv">35</span>, <span class="dt">font=</span><span class="dv">12</span>, <span class="dt">cex=</span><span class="dv">1</span>)</code></pre>
<p><img src="LongPanelDataScripts_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="figure-2.4-added-variable-plot-of-ccpd-versus-year" class="section level3">
<h3><span class="header-section-number">2.2.4</span> Figure 2.4: Added-variable plot of CCPD versus year</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#  CREATE A CATEGORICAL VARIABLE for STATE;</span>
Medicare<span class="op">$</span>FSTATE =<span class="st"> </span><span class="kw">factor</span>(Medicare<span class="op">$</span>STATE)

<span class="co">#  CREATE A NEW VARIABLE;</span>
Medicare<span class="op">$</span>YEAR=Medicare<span class="op">$</span>YEAR<span class="dv">-1989</span>
<span class="co"># THE NEW VARIABLES YR31 WILL BE USED IN THE FINAL MODEL TO GIVE THE 31st STATE A SPECIFIC SLOPE;</span>
Medicare<span class="op">$</span>Yr31=(Medicare<span class="op">$</span>STATE<span class="op">==</span><span class="dv">31</span>)<span class="op">*</span>Medicare<span class="op">$</span>YEAR

<span class="co">#  CREATE A NEW DATA SET, REMOVING THE OUTLIER BY EXCLUDING THE 2ND OBSERVATION OF THE 54TH STATE;</span>
Medicare2 =<span class="st"> </span><span class="kw">subset</span>(Medicare, STATE <span class="op">!=</span><span class="st"> </span><span class="dv">54</span> <span class="op">|</span><span class="st"> </span>YEAR <span class="op">!=</span><span class="st"> </span><span class="dv">2</span>)</code></pre>
<p>Figure 2.4 illustrates the basic added-variable plot. This plot portrays CCPD versus year, after excluding the second observation for the 54th state.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#  BASIC ADDED VARIABLE PLOT;</span>
<span class="co">#  CREATE RESIDUALS;</span>
Med1.lm =<span class="st"> </span><span class="kw">lm</span>(CCPD <span class="op">~</span><span class="st"> </span>FSTATE, <span class="dt">data=</span>Medicare2)
Med2.lm =<span class="st"> </span><span class="kw">lm</span>(YEAR <span class="op">~</span><span class="st"> </span>FSTATE, <span class="dt">data=</span>Medicare2)
Medicare2<span class="op">$</span>rCCPD=<span class="kw">residuals</span>(Med1.lm)
Medicare2<span class="op">$</span>rYEAR=<span class="kw">residuals</span>(Med2.lm)
<span class="kw">plot</span>(rCCPD <span class="op">~</span><span class="st"> </span>rYEAR, <span class="dt">data=</span>Medicare2, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>)
<span class="cf">for</span> (i <span class="cf">in</span> Medicare2<span class="op">$</span>STATE) {
  <span class="kw">lines</span>(rCCPD <span class="op">~</span><span class="st"> </span>rYEAR, <span class="dt">data =</span> <span class="kw">subset</span>(Medicare2, STATE<span class="op">==</span><span class="st"> </span>i)) }
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">6000</span>, <span class="dv">4000</span>, <span class="dt">by=</span><span class="dv">2000</span>), <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">font=</span><span class="dv">10</span>, <span class="dt">cex=</span><span class="fl">0.005</span>, <span class="dt">tck=</span><span class="fl">0.01</span>)
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">6000</span>, <span class="dv">4000</span>, <span class="dt">by=</span><span class="dv">200</span>), <span class="dt">lab=</span>F, <span class="dt">tck=</span><span class="fl">0.005</span>)
<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>, <span class="dt">by=</span><span class="dv">1</span>), <span class="dt">font=</span><span class="dv">10</span>, <span class="dt">cex=</span><span class="fl">0.005</span>, <span class="dt">tck=</span><span class="fl">0.01</span>)
<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>, <span class="dt">by=</span><span class="fl">0.1</span>), <span class="dt">lab=</span>F, <span class="dt">tck=</span><span class="fl">0.005</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Residuals from CCPD&quot;</span>, <span class="dt">side=</span><span class="dv">2</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">8</span>, <span class="dt">at=</span><span class="dv">5000</span>, <span class="dt">font=</span><span class="dv">12</span>, <span class="dt">cex=</span><span class="dv">1</span>, <span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Residuals from YEAR&quot;</span>, <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">line=</span><span class="dv">3</span>, <span class="dt">at=</span><span class="dv">0</span>, <span class="dt">font=</span><span class="dv">12</span>, <span class="dt">cex=</span><span class="dv">1</span>)</code></pre>
<p><img src="LongPanelDataScripts_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="figure-2.5-trellis-plot" class="section level3">
<h3><span class="header-section-number">2.2.5</span> Figure 2.5: Trellis Plot</h3>
<p>A technique for graphical display that has recently become popular in the statistical literature is a trellis plot. This graphical technique takes its name from a trellis, which is a structure of open latticework.
Figure 2.5 illustrates the use of small multiples. In each panel, the plot portrayed is identical except that it is based on a different state; this use of
parallel structure allows us to demonstrate the increasing CCPD for each state.</p>
<pre class="sourceCode r"><code class="sourceCode r">GrpMedicare =<span class="st"> </span><span class="kw">groupedData</span>(CCPD <span class="op">~</span><span class="st"> </span>YEAR<span class="op">|</span><span class="st"> </span>NMSTATE, <span class="dt">data=</span>Medicare2)
<span class="kw">plot</span>(GrpMedicare, <span class="dt">xlab=</span><span class="st">&quot;YEAR&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;CCPD&quot;</span>, <span class="dt">scale =</span> <span class="kw">list</span>(<span class="dt">x=</span><span class="kw">list</span>(<span class="dt">draw=</span><span class="ot">FALSE</span>)), <span class="dt">layout=</span><span class="kw">c</span>(<span class="dv">18</span>,<span class="dv">3</span>))</code></pre>
<p><img src="LongPanelDataScripts_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
</div>
<div id="one-way-fixed-effects-model-using-lm-for-linear-model" class="section level2">
<h2><span class="header-section-number">2.3</span> One way fixed effects model using lm, for linear model</h2>
<p>See Example 2.2: Medicare Hospital Costs.</p>
<pre class="sourceCode r"><code class="sourceCode r">Medicare.lm =<span class="st"> </span><span class="kw">lm</span>(CCPD <span class="op">~</span><span class="st"> </span>NUM.DCHG <span class="op">+</span><span class="st"> </span>Yr31 <span class="op">+</span><span class="st"> </span>YEAR <span class="op">+</span><span class="st"> </span>AVE.DAYS <span class="op">+</span><span class="st"> </span>FSTATE <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data=</span>Medicare2)
<span class="kw">summary</span>(Medicare.lm)</code></pre>
<pre><code>
Call:
lm(formula = CCPD ~ NUM.DCHG + Yr31 + YEAR + AVE.DAYS + FSTATE - 
    1, data = Medicare2)

Residuals:
     Min       1Q   Median       3Q      Max 
-1952.54  -264.66    50.46   300.10  1638.39 

Coefficients:
          Estimate Std. Error t value Pr(&gt;|t|)    
NUM.DCHG    10.755      2.573   4.180 3.96e-05 ***
Yr31      1262.456    128.609   9.816  &lt; 2e-16 ***
YEAR       710.884     26.812  26.513  &lt; 2e-16 ***
AVE.DAYS   361.290     57.979   6.231 1.81e-09 ***
FSTATE1   3888.845    894.076   4.350 1.95e-05 ***
FSTATE2   5694.017    534.048  10.662  &lt; 2e-16 ***
FSTATE3   5736.793    661.153   8.677 4.19e-16 ***
FSTATE4   1639.697    726.577   2.257  0.02484 *  
FSTATE5   1745.883   2402.770   0.727  0.46810    
FSTATE6   5519.532    639.097   8.636 5.52e-16 ***
FSTATE7   5882.663    815.649   7.212 5.77e-12 ***
FSTATE8   6319.729    625.690  10.100  &lt; 2e-16 ***
FSTATE9  12842.939    733.122  17.518  &lt; 2e-16 ***
FSTATE10   990.386   1962.480   0.505  0.61422    
FSTATE11  1352.055   1020.337   1.325  0.18628    
FSTATE12  8524.447    790.980  10.777  &lt; 2e-16 ***
FSTATE13  2700.653    475.750   5.677 3.60e-08 ***
FSTATE14  1417.162   1526.064   0.929  0.35392    
FSTATE15  1383.831    952.843   1.452  0.14760    
FSTATE16  1426.408    696.791   2.047  0.04163 *  
FSTATE17  3146.952    673.351   4.674 4.72e-06 ***
FSTATE18  1728.006    844.017   2.047  0.04161 *  
FSTATE19  3926.979    867.993   4.524 9.16e-06 ***
FSTATE20  3242.727    639.799   5.068 7.54e-07 ***
FSTATE21  -711.562    898.191  -0.792  0.42894    
FSTATE22  1079.195   1161.922   0.929  0.35384    
FSTATE23  2480.023   1236.826   2.005  0.04596 *  
FSTATE24  2293.256    719.640   3.187  0.00161 ** 
FSTATE25   957.334    712.831   1.343  0.18042    
FSTATE26  3299.585    998.712   3.304  0.00109 ** 
FSTATE27  3003.060    494.942   6.068 4.47e-09 ***
FSTATE28  3755.028    615.706   6.099 3.77e-09 ***
FSTATE29 12615.456    598.073  21.094  &lt; 2e-16 ***
FSTATE30  4401.868    669.931   6.571 2.64e-10 ***
FSTATE31 -2649.456   1345.138  -1.970  0.04992 *  
FSTATE32  3589.638    535.271   6.706 1.20e-10 ***
FSTATE33 -4444.768   2367.411  -1.877  0.06155 .  
FSTATE34  1354.039   1071.140   1.264  0.20730    
FSTATE35  2683.031    552.483   4.856 2.05e-06 ***
FSTATE36  -998.648   1578.677  -0.633  0.52755    
FSTATE37  2109.789    736.174   2.866  0.00449 ** 
FSTATE38  3082.538    552.317   5.581 5.90e-08 ***
FSTATE39   260.811   2145.305   0.122  0.90333    
FSTATE40 -2006.729    631.691  -3.177  0.00167 ** 
FSTATE41  2978.161    744.200   4.002 8.16e-05 ***
FSTATE42  3819.468    803.495   4.754 3.28e-06 ***
FSTATE43  2398.622    532.257   4.507 9.90e-06 ***
FSTATE44  1498.689   1017.547   1.473  0.14198    
FSTATE45   277.739   1831.029   0.152  0.87955    
FSTATE46  4580.418    496.141   9.232  &lt; 2e-16 ***
FSTATE47  3612.284    621.289   5.814 1.75e-08 ***
FSTATE48 -2516.614    807.777  -3.115  0.00204 ** 
FSTATE49  2213.600    943.221   2.347  0.01967 *  
FSTATE50  2138.158    685.695   3.118  0.00202 ** 
FSTATE51  2101.881    677.712   3.101  0.00213 ** 
FSTATE52  1138.089    835.624   1.362  0.17437    
FSTATE53  2784.381    471.058   5.911 1.04e-08 ***
FSTATE54 -1037.318    544.265  -1.906  0.05774 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 529.5 on 265 degrees of freedom
Multiple R-squared:  0.9981,    Adjusted R-squared:  0.9977 
F-statistic:  2392 on 58 and 265 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(Medicare.lm)</code></pre>
<pre><code>Analysis of Variance Table

Response: CCPD
           Df     Sum Sq    Mean Sq  F value    Pr(&gt;F)    
NUM.DCHG    1 2.1693e+10 2.1693e+10 77387.47 &lt; 2.2e-16 ***
Yr31        1 6.8708e+07 6.8708e+07   245.11 &lt; 2.2e-16 ***
YEAR        1 1.1974e+10 1.1974e+10 42716.19 &lt; 2.2e-16 ***
AVE.DAYS    1 2.6659e+09 2.6659e+09  9510.30 &lt; 2.2e-16 ***
FSTATE     54 2.4833e+09 4.5986e+07   164.05 &lt; 2.2e-16 ***
Residuals 265 7.4284e+07 2.8032e+05                       
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="section-2.4.1---analysis-for-the-pooling-test" class="section level2">
<h2><span class="header-section-number">2.4</span> SECTION 2.4.1 - Analysis for the pooling test;</h2>
<p>We can check the F-ratio by <code>anova(Medicare.lm,Medicare3.lm)</code>. We reject the null hypothesis from the result below.</p>
<pre class="sourceCode r"><code class="sourceCode r">Medicare3.lm =<span class="st"> </span><span class="kw">lm</span>(CCPD <span class="op">~</span><span class="st"> </span>NUM.DCHG<span class="op">+</span><span class="st"> </span>Yr31 <span class="op">+</span><span class="st"> </span>YEAR <span class="op">+</span><span class="st"> </span>AVE.DAYS , <span class="dt">data=</span>Medicare2)
<span class="kw">summary</span>(Medicare3.lm)</code></pre>
<pre><code>
Call:
lm(formula = CCPD ~ NUM.DCHG + Yr31 + YEAR + AVE.DAYS, data = Medicare2)

Residuals:
    Min      1Q  Median      3Q     Max 
-7176.7 -1255.3  -384.9  1092.4 10350.9 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 4342.1049   873.4212   4.971 1.09e-06 ***
NUM.DCHG       4.6606     0.7241   6.436 4.51e-10 ***
Yr31         299.9270   295.8341   1.014 0.311432    
YEAR         733.2750    94.1398   7.789 9.62e-14 ***
AVE.DAYS     308.4710    86.0766   3.584 0.000392 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 2732 on 318 degrees of freedom
Multiple R-squared:  0.2879,    Adjusted R-squared:  0.279 
F-statistic: 32.15 on 4 and 318 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(Medicare3.lm)</code></pre>
<pre><code>Analysis of Variance Table

Response: CCPD
           Df     Sum Sq   Mean Sq F value    Pr(&gt;F)    
NUM.DCHG    1  463168764 463168764 62.0651 5.317e-14 ***
Yr31        1   33908652  33908652  4.5438 0.0338046 *  
YEAR        1  366756374 366756374 49.1457 1.430e-11 ***
AVE.DAYS    1   95840842  95840842 12.8428 0.0003919 ***
Residuals 318 2373115933   7462629                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(Medicare3.lm,Medicare.lm) <span class="co"># pooling test</span></code></pre>
<pre><code>Analysis of Variance Table

Model 1: CCPD ~ NUM.DCHG + Yr31 + YEAR + AVE.DAYS
Model 2: CCPD ~ NUM.DCHG + Yr31 + YEAR + AVE.DAYS + FSTATE - 1
  Res.Df        RSS Df  Sum of Sq      F    Pr(&gt;F)    
1    318 2373115933                                   
2    265   74284379 53 2298831554 154.73 &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="section-2.4.2---correlation-corresponding-to-the-added-variable-plot" class="section level2">
<h2><span class="header-section-number">2.5</span> SECTION 2.4.2 - Correlation corresponding to the added variable plot;</h2>
<p>As with all scatter plots, the added-variable plot can be summarized numerically through a correlation coefficient that we will denote by <span class="math inline">\(corr(e_1, e_2)\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#  SECTION 2.4.2 - CORRELATION CORRESPONDING TO THE ADDED VARIABLE PLOT;</span>
<span class="kw">library</span>(boot)
<span class="kw">cor</span>(Medicare2<span class="op">$</span>rCCPD , Medicare2<span class="op">$</span>rYEAR)</code></pre>
<pre><code>[1] 0.8847151</code></pre>
</div>
<div id="section-2.4.5---testing-for-heteroscedasticity" class="section level2">
<h2><span class="header-section-number">2.6</span> SECTION 2.4.5 - Testing for heteroscedasticity;</h2>
<p>When fitting regression models to data, an important assumption is that the variability is common among all observations. This assumption of common variability is called homoscedasticity, meaning “same scatter”.</p>
<pre class="sourceCode r"><code class="sourceCode r">Medicare2<span class="op">$</span>Resids=<span class="kw">residuals</span>(Medicare.lm)
Medicare2<span class="op">$</span>ResidSq=Medicare2<span class="op">$</span>Resids<span class="op">*</span>Medicare2<span class="op">$</span>Resids
MedHet.lm =<span class="st"> </span><span class="kw">lm</span>(ResidSq <span class="op">~</span><span class="st"> </span>NUM.DCHG, <span class="dt">data=</span>Medicare2)
<span class="kw">summary</span>(MedHet.lm)</code></pre>
<pre><code>
Call:
lm(formula = ResidSq ~ NUM.DCHG, data = Medicare2)

Residuals:
    Min      1Q  Median      3Q     Max 
-255383 -212155 -143167    7752 3555249 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 261171.0    35324.5   7.393 1.25e-12 ***
NUM.DCHG      -147.5      116.8  -1.264    0.207    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 454200 on 321 degrees of freedom
Multiple R-squared:  0.004949,  Adjusted R-squared:  0.001849 
F-statistic: 1.597 on 1 and 321 DF,  p-value: 0.2073</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(MedHet.lm)</code></pre>
<pre><code>Analysis of Variance Table

Response: ResidSq
           Df     Sum Sq    Mean Sq F value Pr(&gt;F)
NUM.DCHG    1 3.2930e+11 3.2930e+11  1.5966 0.2073
Residuals 321 6.6208e+13 2.0625e+11               </code></pre>
<div id="one-way-random-effects-model-using-lm-for-linear-model" class="section level3">
<h3><span class="header-section-number">2.6.1</span> One way random effects model using lm, for linear model;</h3>
<p>We will learn random effects model in Chapter 3. Here is an example.</p>
<pre class="sourceCode r"><code class="sourceCode r">Medicare.lme =<span class="st"> </span><span class="kw">lme</span>(CCPD <span class="op">~</span><span class="st"> </span>NUM.DCHG, <span class="dt">data=</span>Medicare2, <span class="dt">random =</span> <span class="op">~</span><span class="dv">1</span><span class="op">|</span>STATE)
<span class="kw">summary</span>(Medicare.lme)</code></pre>
<pre><code>Linear mixed-effects model fit by REML
 Data: Medicare2 
       AIC      BIC    logLik
  5733.495 5748.581 -2862.747

Random effects:
 Formula: ~1 | STATE
        (Intercept) Residual
StdDev:    3016.201 1316.346

Fixed effects: CCPD ~ NUM.DCHG 
               Value Std.Error  DF   t-value p-value
(Intercept) 8084.128  564.3211 268 14.325404       0
NUM.DCHG      11.386    1.8044 268  6.310388       0
 Correlation: 
         (Intr)
NUM.DCHG -0.674

Standardized Within-Group Residuals:
       Min         Q1        Med         Q3        Max 
-3.6167201 -0.6276783  0.1998388  0.6325460  2.7846480 

Number of Observations: 323
Number of Groups: 54 </code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="models-with-random-effects.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["LongPanelDataScripts.pdf", "LongPanelDataScripts.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
